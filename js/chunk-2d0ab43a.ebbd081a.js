(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ab43a"],{1511:function(e,r,t){"use strict";t.r(r);var s,a,i=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"container py-5"},[t("UserProfileCard"),t("UserFollowingsCard"),t("UserFollowersCard"),t("UserCommentsCard"),t("UserFavoritedRestaurantsCard")],1)},l=[],o=t("1da1"),n=t("5530"),c=(t("96cf"),t("b0c0"),t("4de4"),t("d3b7"),function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"card mb-4"},[t("div",{staticClass:"row no-gutters"},[t("div",{staticClass:"col-sm-7 col-md-5 col-lg-4"},[t("img",{attrs:{src:e.userProfile.image,width:"300px",height:"300px"}})]),t("div",{staticClass:"col-sm-5 col-md-7 col-lg-8"},[t("div",{staticClass:"card-body"},[t("h5",{staticClass:"card-title"},[e._v(e._s(e.userProfile.name))]),t("p",{staticClass:"card-text"},[e._v("u"+e._s(e.userProfile.email))]),t("ul",{staticClass:"list-unstyled list-inline"},[t("li",[t("strong",[e._v(e._s(e.userProfile.Comments.length))]),e._v(" 已評論餐廳 ")]),t("li",[t("strong",[e._v(e._s(e.userProfile.FavoritedRestaurants.length))]),e._v(" 收藏的餐廳 ")]),t("li",[t("strong",[e._v(e._s(e.userProfile.Followings.length))]),e._v(" followings (追蹤者) ")]),t("li",[t("strong",[e._v(e._s(e.userProfile.Followers.length))]),e._v(" followers (追隨者) ")])]),e.currentUser.isAdmin||e.currentUser.id==e.userProfile.id?t("router-link",{staticClass:"btn btn-secondary me-2",attrs:{to:{name:"user-edit",params:{id:e.userProfile.id}}}},[e._v("編輯")]):e._e(),e.currentUser.id!=e.userProfile.id?t("form",{staticStyle:{display:"contents"},attrs:{action:"/following/2",method:"POST"},on:{submit:function(r){return r.stopPropagation(),r.preventDefault(),e.handleFollowingClick(e.userProfile.id)}}},[e.isFollowed?t("button",{staticClass:"btn btn-danger",attrs:{type:"submit"}},[e._v(" 取消追蹤 ")]):t("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[e._v("追蹤")])]):e._e(),t("p")],1)])])])}),u=[],d={props:{userProfile:{type:Object,required:!0},isFollowed:{type:Boolean,defalt:!1},currentUser:{type:Object,required:!0}},methods:{handleFollowingClick:function(e){this.$emit("toggle-following-status",e)}}},f=d,m=t("2877"),v=Object(m["a"])(f,c,u,!1,null,null,null),g=v.exports,p=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"card"},[t("div",{staticClass:"card-header"},[t("strong",[e._v(e._s(e.userProfile.Followings.length))]),e._v(" followings (追蹤者) ")]),t("div",{staticClass:"card-body"},e._l(e.userProfile.Followings,(function(e){return t("router-link",{key:e.id,staticClass:"m-1",attrs:{to:{name:"user",params:{id:e.id}}}},[t("img",{staticClass:"avatar rounded-1",attrs:{src:e.image,width:"60",height:"60"}})])})),1)])},w=[],h={props:{userProfile:{type:Object,required:!0}}},b=h,C=Object(m["a"])(b,p,w,!1,null,null,null),_=C.exports,P=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"card"},[t("div",{staticClass:"card-header"},[t("strong",[e._v(e._s(e.userProfile.Followers.length))]),e._v(" followers (追隨者) ")]),t("div",{staticClass:"card-body"},e._l(e.userProfile.Followers,(function(e){return t("router-link",{key:e.id,staticClass:"m-1",attrs:{to:{name:"user",params:{id:e.id}}}},[t("img",{staticClass:"avatar rounded-1",attrs:{src:e.image,width:"60",height:"60"}})])})),1)])},F=[],U={props:{userProfile:{type:Object,required:!0}}},k=U,x=Object(m["a"])(k,P,F,!1,null,null,null),y=x.exports,O=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"card"},[t("div",{staticClass:"card-header"},[t("strong",[e._v(e._s(e.userProfile.Comments.length))]),e._v(" 已評論餐廳")]),e._v("> "),t("div",{staticClass:"card-body"},e._l(e.userProfile.Cooments,(function(e){return t("router-link",{key:e.id,attrs:{to:{name:"restaurant",params:{id:e.Restaurant.id}}}},[t("img",{staticClass:"avatar m-1 rounded-1",attrs:{src:e.Restaurant.image,width:"60",height:"60"}})])})),1)])},j=[],R={props:{userProfile:{type:Object,required:!0}}},E=R,$=Object(m["a"])(E,O,j,!1,null,null,null),q=$.exports,I={},S=Object(m["a"])(I,s,a,!1,null,null,null),A=S.exports,J=t("4cce"),B=t("2fa3"),D=t("2f62"),T={components:{UserProfileCard:g,UserFollowingsCard:_,UserFollowersCard:y,UserCommentsCard:q,UserFavoritedRestaurantsCard:A},data:function(){return{userProfile:{id:-1,name:"",email:"",isAdmin:!1,image:"",Comments:[],FavoritedRestaurants:[],Followers:[],Followings:[]},isFollowed:!1}},computed:Object(n["a"])({},Object(D["b"])(["currentUser"])),created:function(){var e=this.$route.params.id;this.fetchUserProfile(e)},beforeRouteUpdate:function(e,r,t){var s=e.params.id;this.fetchUserProfile(s),t()},methods:{fetchUserProfile:function(e){var r=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,J["a"].getUser({userId:e});case 3:if(s=t.sent,a=s.data,0!==a.profile.name.length){t.next=7;break}throw new Error("error");case 7:r.userProfile=Object(n["a"])(Object(n["a"])({},r.userProfile),a.profile),r.isFollowed=a.isFollowed,t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),B["a"].fire({icon:"error",title:"無法取得用戶資料，請稍後再試"});case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))()},toggleFollowingStatus:function(e){var r=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var s,a,i,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,e===r.currentUser.id){t.next=21;break}if(!r.isFollowed){t.next=13;break}return t.next=5,J["a"].deleteFollowing({userId:e});case 5:if(s=t.sent,a=s.data,"success"===a.status){t.next=9;break}throw new Error(a.message);case 9:r.isFollowed=!1,r.userProfile.Followers=r.userProfile.Followers.filter((function(e){return e.id!==r.currentUser.id})),t.next=21;break;case 13:return t.next=15,J["a"].addFollowing({userId:e});case 15:if(i=t.sent,l=i.data,"success"===l.status){t.next=19;break}throw new Error(l.message);case 19:r.isFollowed=!0,r.userProfile.Followers.push(r.currentUser);case 21:t.next=26;break;case 23:t.prev=23,t.t0=t["catch"](0),B["a"].fire({icon:"error",title:"無法更新追蹤狀態，請稍後再試"});case 26:case"end":return t.stop()}}),t,null,[[0,23]])})))()}}},z=T,G=Object(m["a"])(z,i,l,!1,null,null,null);r["default"]=G.exports}}]);
//# sourceMappingURL=chunk-2d0ab43a.ebbd081a.js.map